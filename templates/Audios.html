<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    
    <!-- Theme initialization - prevents flash -->
    <script>
    (function(){
        var t=localStorage.getItem('darkMode');
        if(t==='true'){
            // Usar un intervalo muy corto para aplicar apenas el body esté disponible
            var applyTheme=function(){
                if(document.body){
                    document.body.classList.add('dark');
                }else{
                    setTimeout(applyTheme,1);
                }
            };
            applyTheme();
        }
    })();
    </script>
    <!-- Profile initialization - prevents flash -->
    <script>(function(){var u=localStorage.getItem('userInfo');if(u){try{var user=JSON.parse(u);window.__userInfo=user;}catch(e){}}})();</script>
<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="icon" type="image/x-icon" href="/static/images/logo.png">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">  
    <title>HeromovilApp - Audios</title>
</head>

<body>

    <!-- Sidebar -->
    <div class="sidebar close">
        <a href="#" class="logo">
            <i class='bx bx-store-alt'></i>
            <div class="logo-name"><span>Hero</span>Movil</div>
        </a>
        <ul class="side-menu">
        <ul class="side-menu">
            <li><a href="{{ url_for('main.home') }}"><i class='bx bxs-dashboard'></i>Inicio</a></li>            
            <li><a href="{{ url_for('main.dashboard') }}"><i class='bx bx-analyse'></i>Analiticas</a></li>            
            <li><a href="{{ url_for('main.comisiones') }}"><i class='bx bx-dollar'></i>Comisiones</a></li>
            <li><a href="{{ url_for('main.posiciones') }}"><i class='bx bx-group'></i>Posiciones</a></li>
            <li><a href="{{ url_for('main.procesos') }}"><i class='bx bx-atom'></i>Procesos</a></li> 
            <li><a href="{{ url_for('main.mantenimientos') }}"><i class='bx bx-cog'></i>Mantenimientos</a></li>          
            <li class="active"><a href="{{ url_for('main.audios') }}"><i class='bx bx-music'></i>Audios</a></li>
        </ul>
        </ul>
        <ul class="side-menu">
            <li>
                <a href="{{ url_for('main.index') }}" class="logout">
                    <i class='bx bx-log-out-circle'></i>
                    Logout
                </a>
            </li>
        </ul>
    </div>
    <!-- End of Sidebar -->

    <!-- Main Content -->
    <div class="content">
        <!-- Navbar -->
        <nav>
            <i class='bx bx-menu'></i>
            <form action="#">
                <div class="dateTime" id="clock"></div>
            </form>
            <label for="switch" class="switch">
                <input id="switch" type="checkbox" />
                <span class="slider"></span>
                <span class="decoration"></span>
            </label>
            
            <div class="profile">
                <img src="/static/images/logo.png" id="profile-img">
            </div>
        </nav>
            <!-- Apply profile image immediately -->
    <script>(function(){if(window.__userInfo){var u=window.__userInfo;var img=document.getElementById('profile-img');if(img&&u.codigo_usuario){img.src='/static/images/'+u.codigo_usuario+'.jpg';img.onerror=function(){this.src='/static/images/logo.png';this.onerror=null;};}}})();</script>

<!-- End of Navbar -->
        
        <main> 
            <div class="bottom-data">
                <div class="orders">
                    <div class="header">
                        <i class='bx bx-music'></i>
                        <h3>Gestión de Audios</h3>
                    </div>
                    
                    <div id="audio-container" class="audio-grid">
                        <!-- Cards will be injected here by audios.js -->
                    </div>
                </div>
            </div>
        </main>
    </div>

     <style>
                /* Audio Cards Styles */
                .audio-grid {
                    display: grid;
                    /* Adjusted minmax to allow 5 per row on standard screens */
                    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                    gap: 16px;
                    padding: 20px 0;
                }

                .audio-card {
                    background: var(--light);
                    border-radius: 16px;
                    padding: 16px;
                    display: flex;
                    flex-direction: column;
                    gap: 12px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
                    transition: transform 0.3s ease, box-shadow 0.3s ease;
                    position: relative;
                    overflow: hidden;
                }

                .audio-card:hover {
                    transform: translateY(-3px);
                    box-shadow: 0 6px 16px rgba(0,0,0,0.1);
                }

                .audio-info {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 8px;
                    text-align: center;
                }

                .icon-wrapper {
                    width: 48px;
                    height: 48px;
                    background: var(--primary);
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: var(--light);
                    font-size: 24px;
                    margin-bottom: 4px;
                }

                .audio-info h3 {
                    font-size: 14px;
                    font-weight: 600;
                    color: var(--dark);
                    margin: 0;
                    /* Limit text to 2 lines */
                    display: -webkit-box;
                    -webkit-line-clamp: 2;
                    -webkit-box-orient: vertical;
                    overflow: hidden;
                }

                /* Visualizer Animation */
                .visualizer {
                    display: flex;
                    align-items: flex-end;
                    gap: 3px;
                    height: 16px;
                    opacity: 0.3;
                    transition: opacity 0.3s;
                }

                .visualizer.active {
                    opacity: 1;
                }

                .visualizer span {
                    width: 3px;
                    background: var(--primary);
                    border-radius: 2px;
                    animation: bounce 1s infinite ease-in-out;
                    animation-play-state: paused;
                }

                .visualizer.active span {
                    animation-play-state: running;
                }

                .visualizer span:nth-child(1) { height: 8px; animation-delay: 0.1s; }
                .visualizer span:nth-child(2) { height: 12px; animation-delay: 0.3s; }
                .visualizer span:nth-child(3) { height: 16px; animation-delay: 0.0s; }
                .visualizer span:nth-child(4) { height: 10px; animation-delay: 0.4s; }
                .visualizer span:nth-child(5) { height: 8px; animation-delay: 0.2s; }

                @keyframes bounce {
                    0%, 100% { height: 3px; }
                    50% { height: 16px; }
                }

                .audio-controls {
                    display: flex;
                    justify-content: center;
                    gap: 12px;
                    margin-top: auto;
                }

                .audio-controls button {
                    width: 36px;
                    height: 36px;
                    border-radius: 50%;
                    border: none;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 18px;
                    transition: all 0.2s ease;
                }

                .btn-play {
                    background: var(--primary);
                    color: var(--light);
                }

                .btn-play:hover {
                    transform: scale(1.1);
                    background: var(--primary-dark, #1976D2);
                }

                .btn-play.playing {
                    background: var(--warning);
                }

                .btn-stop {
                    background: var(--grey);
                    color: var(--dark);
                }

                .btn-stop:not(:disabled):hover {
                    background: var(--danger);
                    color: var(--light);
                    transform: scale(1.1);
                }

                .btn-stop:disabled {
                    opacity: 0.5;
                    cursor: not-allowed;
                }

                /* Dark Mode Adjustments */
                body.dark .audio-card {
                    background: var(--dark-grey);
                }
                
                body.dark .audio-info h3 {
                    color: var(--light);
                }
            </style>
    
<script src="{{ url_for('static', filename='js/session_manager.js') }}"></script>
<script src="{{ url_for('static', filename='js/audios.js') }}"></script>
<script src="{{ url_for('static', filename='js/darkMode.js') }}"></script>
<script src="{{ url_for('static', filename='js/role_ui_manager.js') }}"></script>
<script src="{{ url_for('static', filename='js/Clock.js') }}"></script>
    <script>
        // Initialize clock
        window.addEventListener('DOMContentLoaded', function() {
            getthedate();
            goforit();
        });
    </script>

</body>

</html>
