<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Theme initialization - prevents flash -->
    <script>
    (function(){
        var t=localStorage.getItem('darkMode');
        if(t==='true'){
            // Usar un intervalo muy corto para aplicar apenas el body esté disponible
            var applyTheme=function(){
                if(document.body){
                    document.body.classList.add('dark');
                }else{
                    setTimeout(applyTheme,1);
                }
            };
            applyTheme();
        }
    })();
    </script>
    <!-- Profile initialization - prevents flash -->
    <script>(function(){var u=localStorage.getItem('userInfo');if(u){try{var user=JSON.parse(u);window.__userInfo=user;}catch(e){}}})();</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.6.0/dist/chart.min.js"></script>
  <link rel="icon" type="image/x-icon" href="/static/images/logo.png">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <link rel="icon" type="image/x-icon" href="/static/images/logo.png">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/cargas.css') }}">
  <title>HeromovilApp</title>
</head>

<body>
  <!-- Sidebar -->
  <div class="sidebar close">
    <a href="#" class="logo">
      <i class='bx bx-store-alt'></i>
      <div class="logo-name"><span>Hero</span>Movil</div>
    </a>
        <ul class="side-menu">
            <li><a href="{{ url_for('main.home') }}"><i class='bx bxs-dashboard'></i>Inicio</a></li>            
            <li class="active"><a href="{{ url_for('main.dashboard') }}"><i class='bx bx-analyse'></i>Analiticas</a></li>            
            <li><a href="{{ url_for('main.comisiones') }}"><i class='bx bx-dollar'></i>Comisiones</a></li>
            <li><a href="{{ url_for('main.posiciones') }}"><i class='bx bx-group'></i>Posiciones</a></li>
            <li><a href="{{ url_for('main.procesos') }}"><i class='bx bx-atom'></i>Procesos</a></li> 
            <li><a href="{{ url_for('main.mantenimientos') }}"><i class='bx bx-cog'></i>Mantenimientos</a></li>          
            <li><a href="{{ url_for('main.audios') }}"><i class='bx bx-music'></i>Audios</a></li>
        </ul>
    <ul class="side-menu">
      <li>
        <a href="{{ url_for('main.index') }}" class="logout">
          <i class='bx bx-log-out-circle'></i>
          Salir
        </a>
      </li>
    </ul>
  </div>
  <!-- End of Sidebar -->

  <!-- Main Content -->
  <div class="content">
    <!-- Navbar -->
    <nav>
      <i class='bx bx-menu'></i>

      <form action="#">
        <div class="dateTime" id="clock"></div>
      </form>

      <label for="switch" class="switch">
        <input id="switch" type="checkbox" />
        <span class="slider"></span>
        <span class="decoration"></span>
      </label>

      <div class="profile">
                <img src="/static/images/logo.png" id="profile-img">
            </div>
    </nav>
        <!-- Apply profile image immediately -->
    <script>(function(){if(window.__userInfo){var u=window.__userInfo;var img=document.getElementById('profile-img');if(img&&u.codigo_usuario){img.src='/static/images/'+u.codigo_usuario+'.jpg';img.onerror=function(){this.src='/static/images/logo.png';this.onerror=null;};}}})();</script>

<!-- End of Navbar -->

    <!--Info-->
    <main>
      <div class="header">
        <div class="left">
          <h1>Dashboard</h1>
          <ul class="breadcrumb">
            <li><a href="#">
                Analiticas
              </a></li>
            /
            <li><a href="#" class="active">Ventas</a></li>
          </ul>
        </div>
      </div>
      <!-- End of info -->

      <!--Selector de Empleado-->
      <ul class="insights">
         <li>          
         <span class="info">  
            <p>Supervisor:</p>         
              <select id="supervisoreSelect" class="form-input"> 
                <option value="" selected>Supervisor</option>
              </select>            
          </span>
        </li>
        <li>
          <span class="info">
            <p>Vendedor: </p>            
            <div class="form-input">                            
              <select id="employeeSelect">
                <option value="" selected>Vendedor</option>
              </select>
            </div>
          </span>
        </li>
      </ul>
      <!--Selector de Empleado Fin-->

      <!-- Tarjetas -->
      <ul class="insights">
        <li>
          <i class='bx bx-wink-smile'></i>
          <span class="info">
            <h3 id="pav-value">0</h3>
            <p>PAV</p>
          </span>
        </li>
        <li><i class='bx bx-show-alt'></i>
          <span class="info">
            <h3 id="clientes-value">0</h3>
            <p>Clientes Atendidos(Pagos)</p>
          </span>
        </li>
        <li><i class='bx bx-line-chart'></i>
          <span class="info">
            <h3 id="conversion-value">0%</h3>
            <p>Conversion</p>
          </span>
        </li>
        <li><i class='bx bx-dollar-circle'></i>
          <span class="info">
            <h3 id="recargas-value">$0</h3>
            <p>Recargas</p>
          </span>
        </li>
      </ul>
      <!--Fin tarjetas -->

      <!-- Tabla Totales Objetivos vs Resultados -->
      <div class="bottom-data" id="obj-rest-total-container" style="display: none;">
        <div class="orders" id="obj-rest-total" name="obj-rest-total">
          <div class="header">
            <i class='bx bx-bar-chart'></i>
            <h3>Totales Objetivos vs Resultados (Mes Actual)</h3>
          </div>
          <table class="greyGridTable">
            <thead>
              <tr>
                <th>
                  <h2>Producto</h2>
                </th>
                <th>
                  <h2>Objetivo</h2>
                </th>
                <th>
                  <h2>Resultado</h2>
                </th>
                <th>
                  <h2>Logro</h2>
                </th>
                <th>
                  <h2>Proyeccion</h2>
                </th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <!-- Fin Tabla Totales -->

      <!-- Tabla Ordenes -->
      <div class="bottom-data" id="obj-rest-container">
        <div class="orders" id="obj-rest" name="obj-rest">
          <div class="header">
            <i class='bx bx-bar-chart'></i>
            <h3>Obetivos vs Resultados</h3>
            <i class='bx bx-filter'>
              <input type="date">
            </i>
            <i id="btnBuscarVentas" class='bx bx-search'>

            </i>
          </div>
          <table class="greyGridTable">
            <thead>
              <tr>
                <th>
                  <h2>Producto</h2>
                </th>
                <th>
                  <h2>Objetivo</h2>
                </th>
                <th>
                  <h2>Resultado</h2>
                </th>
                <th>
                  <h2>Logro</h2>
                </th>
                <th>
                  <h2>Proyeccion</h2>
                </th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <!-- tabla empleados -->

      <!-- Tabla CR Diario  -->
      <div class="bottom-data">
        <div class="orders" id="conversion-rate" name="conversion-rate">
          <div class="header">
            <i class='bx bx-bar-chart'></i>
            <h3>Conversion Rate Diario</h3>
            <i class='bx bx-filter'>
              <input type="date">
            </i>
            <i id="btnBuscar" class='bx bx-search'>
            </i>
          </div>
          <table class="greyGridTable">
            <thead>
              <tr>
                <th>
                  <h2>Vendedor</h2>
                </th>
                <th>
                  <h2>PAV</h2>
                </th>
                <th>
                  <h2>Clientes</h2>
                </th>
                <th>
                  <h2>CR %</h2>
                </th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <!-- tabla CR Diario Fin -->

      <!-- Datos Generales -->
      <div class="bottom-data">
        <div class="orders">
          <!--Chart lieal inicio-->
          <section id="main-chart" class="recent-orders">
            <div class="ordenp">
              <div class="form-input">
                Año:
                <select class="selectFiltrar" id="yearSelect">
                  <option value="2023">2023</option>
                  <option value="2024">2024</option>
                  <option value="2025" selected>2025</option>
                </select>
              </div>
              <div class="form-input">
                Tipo:
                <select class="selectFiltrar" id="modeSelect">
                  <option value="resultados">Resultados</option>
                  <option value="logro">Logro</option>
                </select>
              </div>
            </div>
            <header>
              <div class="wrapper-reach">
                <div class="wrapper-filter">
                  <div class="filters">
                    <div class="filter selected" data-label="Todos">
                      <p>Todo</p>
                    </div>
                    <div class="filter" data-label="Card">
                      <p>Card</p>
                    </div>
                    <div class="filter" data-label="Flex/Max">
                      <p>Pospago</p>
                    </div>
                    <div class="filter" data-label="Internet">
                      <p>Internet</p>
                    </div>
                    <div class="filter" data-label="Migraciones">
                      <p>Migraciones</p>
                    </div>
                    <div class="filter" data-label="Fidepuntos Pos">
                      <p>Fide Pos</p>
                    </div>
                    <div class="filter" data-label="Fidepuntos Up">
                      <p>Fide Up</p>
                    </div>
                    <div class="filter" data-label="Reemplazo Pos">
                      <p>Reemplazo Pos</p>
                    </div>
                    <div class="filter" data-label="Reemplazo Up">
                      <p>Reemplazo Up</p>
                    </div>
                    <div class="filter" data-label="Fide Reemp Internet Up">
                      <p>Fide Reemp Internet +Up</p>
                    </div>
                    <div class="filter" data-label="Aumentos">
                      <p>Aumentos Pos/Net</p>
                    </div>
                  </div>
                </div>
              </div>
            </header>
            <div class="chart">
              <canvas id="chartMain" width="700" height="200"></canvas>
            </div>
          </section>
          <!--Chart lieal inicio-->
        </div>
      </div>
    </main>

  </div>
  <!-- Antes del cierre </body>, agregar: -->
<script src="{{ url_for('static', filename='js/session_manager.js') }}"></script>
  <script src="{{ url_for('static', filename='js/role_ui_manager.js') }}"></script>
  <script src="{{ url_for('static', filename='js/charts.js') }}"></script>
  <script src="{{ url_for('static', filename='js/objrest.js') }}"></script>
  <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
  <script src="{{ url_for('static', filename='js/darkMode.js') }}"></script>
  <script src="{{ url_for('static', filename='js/conversion-rate.js') }}"></script>
  <script src="{{ url_for('static', filename='js/Clock.js') }}"></script>
  <script>
    // Initialize clock
    window.addEventListener('DOMContentLoaded', function() {
        getthedate();
        goforit();
    });
</script>
</body>
</html>